server:
  port: ${PORT:8080} # Default port is 8080 unless specified

# Spring konfiguracija
spring:
  cache:
    type: none
  # Datasource i JPA postavke
  jpa:
    show-sql: true
    hibernate:
      ddl-auto: none
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQLDialect
        connection.useUnicode: true
        connection.characterEncoding: UTF-8
        connection.charSet: UTF-8
    open-in-view: false

  # Iskljuƒçenje automatske Spring Security konfiguracije
  autoconfigure:
    exclude: org.springframework.boot.autoconfigure.security.SecurityAutoConfiguration

  # JOOQ postavke
  jooq:
    sql-dialect: MYSQL

  # Liquibase postavke
  liquibase:
    change-log: classpath:/db/changelog/db.changelog-master.xml
    enabled: false

  # Mail server konfiguracija
  mail:
    host: ${MAIL_HOST:sofija.orion.rs}
    port: ${MAIL_PORT:587}
    username: ${MAIL_USERNAME:webshop@automaterijal.com}
    password: 'Crninovembar18!!'
    protocol: smtp
    defaultEncoding: UTF-8
    properties:
      mail:
        smtp:
          auth: true
          ssl:
            enable: ${MAIL_SMTP_SSL_ENABLE:false}
            trust: ${MAIL_SSL_TRUST:${MAIL_HOST:sofija.orion.rs}}
            checkserveridentity: ${MAIL_SSL_CHECK_SERVER_IDENTITY:true}
          starttls:
            enable: ${MAIL_SMTP_STARTTLS_ENABLE:true}
            required: ${MAIL_SMTP_STARTTLS_REQUIRED:true}

  servlet:
    multipart:
      max-file-size: 20MB
      max-request-size: 20MB

# Podesavanje scheduler-a
schedule:
  izvestaj:
    podsetnik: 0 0 6 * * *

# JWT konfiguracija
automaterijal:
  jwtSecret: bezKoderSecretKey
  jwtExpirationMs: 43200000

# Logging konfiguracija
logging:
  file:
    name: ../logs/arhiva/automaterijal

showcase:
  cache:
    reset:
      ms: 172800000   # 48h

# In case we want to use offline mode
offline: false

site:
  base-url: https://automaterijal.com
sitemap:
  brand-prefix: /webshop/manufacturers
  brand-details-prefix: /brendovi
  category-prefix: /webshop/category
  blog-prefix: /blog
  products:
    refresh-cron: 0 0 2 * * *
  vehicles:
    prefix: /webshop/vozila
    linking-target-type: PO
    refresh-cron: 0 30 3 * * *
    model-end-cutoff-year: 1995

blog:
  cover-image:
    directory: ../uploads/blog-cover

integration:
  providers:
    rules:
      - provider: febi-stock
        enabled: true
        priority: 100
        purposes: [INVENTORY_ENRICHMENT, EXTERNAL_OFFER]
        brands: [FEBI, BLUE]
        bulk-mode: SAME_BRAND
      - provider: gazela
        enabled: true
        priority: 60
        purposes: [INVENTORY_ENRICHMENT, EXTERNAL_OFFER]
        maxLocalAvailableCount: 20
        bulk-mode: MIXED_BRAND
      - provider: szakal
        enabled: true
        priority: 50
        purposes: [INVENTORY_ENRICHMENT, EXTERNAL_OFFER]
        maxLocalAvailableCount: 20
        bulk-mode: SAME_BRAND
  febi:
    max-items-per-request: ${FEBI_MAX_ITEMS_PER_REQUEST:25}
    order:
      mode: DISABLED
      base-url: https://bis1.prod.apimanagement.eu20.hana.ondemand.com/p/v1/order-api/api/v1
      customer-order-prefix: "AK AM "
      requested-delivery-offset-days: 0
      simulate-before-create: false
      require-availability: true
      delivery-party: ${FEBI_ORDER_DELIVERY_PARTY:0001001983}
      pickup-delivery-party: ${FEBI_ORDER_PICKUP_DELIVERY_PARTY:0001003023}
      shipping-condition: ${FEBI_ORDER_SHIPPING_CONDITION:S9}
  szakal:
    enabled: ${SZAKAL_ENABLED:false}
    order:
      mode: ${SZAKAL_ORDER_MODE:DISABLED}
    data-dir: ${SZAKAL_DATA_DIR:./data/szakal}
    currency: RSD
    lead-time-list0: 1
    lead-time-list1: 2
    lead-time-list2: 3
    lead-time-list3: 5
    warehouse-name: SZAKAL
    sftp:
      host: store.szakalmetal.hu
      port: 1221
      username: 22EJrs
      password: Chou7aech9je
      remote-dir: down
      connect-timeout-ms: 10000
      read-timeout-ms: 60000
    sync:
      enabled: false
      run-on-start: false
      run-weekly-on-start: false
      cron-pricelists: "0 0 3 * * *"
      cron-weekly: "0 0 3 * * SUN"
      max-retries: 3
      retry-backoff-ms: 2000
    search:
      oe-expansion-enabled: true
      oe-expansion-min-available: 5
      oe-expansion-max-oe: 10
      oe-expansion-max-results: 50
      oe-fallback-min-available: 2
      max-batch-size: ${SZAKAL_SEARCH_MAX_BATCH_SIZE:20}
    api:
      base-url: ${SZAKAL_API_BASE_URL:https://webservice.szakalmetal.hu}
      username: automaterijal
      password: automaterijal
      connect-timeout-ms: 10000
      read-timeout-ms: 10000
      cache-ttl-ms: 120000
      stock-check-max-concurrency: 3
  gazela:
    enabled: ${GAZELA_ENABLED:false}
    currency: RSD
    # Legacy fallback keys (kept for backward compatibility).
    warehouse-sabac-id: 9
    default-delivery-business-days: 1
    delivery-profile:
      city-branch-aware: true
      default-delivery-business-days-min: 1
      default-delivery-business-days-max: 2
    api:
      base-url: ${GAZELA_API_BASE_URL:}
      user-id: ${GAZELA_API_USER_ID:}
      password: ${GAZELA_API_PASSWORD:}
      connect-timeout-ms: ${GAZELA_API_CONNECT_TIMEOUT_MS:10000}
      read-timeout-ms: ${GAZELA_API_READ_TIMEOUT_MS:10000}
      max-batch-size: ${GAZELA_API_MAX_BATCH_SIZE:20}
      reference-cache-ttl-ms: ${GAZELA_API_REFERENCE_CACHE_TTL_MS:86400000}

pricing:
  margin:
    default-percent: 0.60
    by-group:
      ZAM: 0.40
      AK: 0.30
      KVAC: 0.50
    by-provider:
      FEBI-STOCK:
        default-percent: 0.65

roba:
  search:
    max-provider-items: ${ROBA_SEARCH_MAX_PROVIDER_ITEMS:20}
  slika:
    publicPrefix: /images/roba/
    noImageUrl: /images/no-image/no-image.png
